MedusaLocker uses a different way of achieving persistence. It uses official Microsoft Documented Code for achieving persistence by scheduling a task with repetition of 15 minutes indefinitely. Typically, malware uses either at.exe or schtasks.exe which are official Microsoft apps for scheduling tasks, but in this case the malware scheduled task programmatically in c++ using official code from MSDN page of Microsoft.

The malware creates a copy of itself with the name of “svhost.exe” in %APPDATA% of the system and registers itself in task scheduler to be executed after every 15 minutes indefinitely. In this TTP, instead of copying itself, it copies cmd for demonstration purposes.

For educational purposes only!
