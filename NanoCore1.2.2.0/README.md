# NanoCore 1.2.2.0

<p align="center">
  <img src="Assets/RAT.png" alt="RAT Image" width="300px">
</p>

This repo includes the technical analysis of a commercial RAT which is easily available on black market for cheap price. NanoCore is a famous Remote Access Trojan malicious software that has its own client builder and multiple delivery methods.

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h3>NanoCore RAT 1.2.2.0 Analysis PDF Report</h3>
  <br>
	<div style="display:flex;justify-content:center;align-items:center;height:100vh;"><iframe src="NanoCore_1.2.20.pdf" width="600px" height="750px"></iframe></div>
<br>
</body>
</html>


In this repo, the original sample of NanoCore 1.2.2.0 is provided along with its extracted stages samples.
The password is **"infected"** for all archieves.

### NanoCore 1.2.2.0 RAT TTPs
<table>
  <thead>
    <tr>
      <th>TTP</th>
      <th>Description</th>
	  <th>Code</th>
	  <th>Detection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://attack.mitre.org/techniques/T1056/001/">Credential Access: Input Capture: Keylogging</a></td>
      <td>NanoCore has keylogging capabilities in its surveillanceEx plugin</td>
	  <td><a href="./Extracted_TTPs/NanoCore_Keylogging">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
    <tr>
      <td><a href="https://attack.mitre.org/techniques/T1053/005/">Privilege Escalation: Scheduled Task/Job: Scheduled Task</a></td>
      <td>NanoCore uses task scheuduler in a unique way to escalate privileges</td>
	  <td><a href="./Extracted_TTPs/NanoCore_PrivEscalation">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
	<tr>
      <td><a href="https://attack.mitre.org/techniques/T1547/001/">Persistence: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</a></td>
      <td>NanoCore achieves persistence by abusing windows Run Registry Keys</td>
	  <td><a href="./Extracted_TTPs/NanoCore_PersistenceRegKeys">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
	<tr>
      <td><a href="https://attack.mitre.org/techniques/T1115/">Collection: Clipboard Data</a></td>
      <td>NanoCore steals clipboard data by setting itself as a clipboard viewer</td>
	  <td><a href="./Extracted_TTPs/NanoCore_ClipboardLogging">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
	<tr>
      <td><a href="https://attack.mitre.org/techniques/T1005/">Collection: Data from Local System</a></td>
      <td>NanoCore steals DNS records from the DNS cache of victim system</td>
	  <td><a href="./Extracted_TTPs/NanoCore_DNSLogging">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
	<tr>
      <td><a href="https://attack.mitre.org/techniques/T1562/001/">Impair Defenses: Disable or Modify Tools</a></td>
      <td>NanoCore prevents security tools from terminating the process without crashing the system, effectively disabling their ability to mitigate the threat</td>
	  <td><a href="./Extracted_TTPs/NanoCore_CriticalProcess">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
	<tr>
      <td><a href="https://attack.mitre.org/techniques/T1553/005/">Defense Evasion: Subvert Trust Controls: Mark-of-the-Web Bypass</a></td>
      <td>NanoCore can bypass Mark-of-the-Web by deleting Zone.Identifier tags</td>
	  <td><a href="./Extracted_TTPs/NanoCore_MOTWBypass">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
    <tr>
      <td><ul>
	<li><a href="https://attack.mitre.org/techniques/T1055/012/">Defense Evasion: Process Injection: Process Hollowing</a></li>
	<li><a href="https://attack.mitre.org/techniques/T1027/002/">Defense Evasion: Obfuscated Files or Information: Software Packing</a></li>
      </ul></td>
      <td>NanoCore execute its stage2 malware by extracting it from the resources and injecting it inside another instance of stage1 process using Process Hollowing</td>
	  <td><a href="./Extracted_TTPs/NanoCore_ProcessHollowing">Code</a></td>
	  <td>Rule/Query Coming Soon!</td>
    </tr>
	<tr>
      <td><a href="https://attack.mitre.org/techniques/T1095/">Command & Control: Non-Application Layer Protocol</a></td>
      <td>NanoCore creates RAW sockets for c2 communication and data exfiltration</td>
	  <td>Code coming soon...</td>
	  <td>Rule\Query coming soon...</td>
    </tr>
  </tbody>
</table>

Note: Artifacts & code of this repository is inteneded for educational purposes only!
