This is a memory patch TTP extracted from Xloader4.3. The xloader AKA formbook, hides its core malicious functionality under the guise of encrypted core malicious functions that are patched at run-time in the memory during its exectution. This POC aims to recreate a simplified version of xloader memory patching ttp by finding encrypted signature bytes, then decrypt and execute those bytes.

The screenshot explains the simple process of preparing the binary (payload) by patching encrypted bytes to its text section for delivery.
1. Highlighted yellow bytes represent signature bytes
2. Red bytes are encrypted patched bytes to the original binary. The patched bytes will avoid detection and will be decrypted by program itself on execution before reaching that particular address space in memory. Without decryption&patching, the program will crash.

In the scenario of Xloader4.3 malware, it had included whole malicious functions inside the signature bytes and kept in the encrypted format that are decrypted by program itself on execution before reaching to that particular area in memory. Hence, evading defenses by completely modifying and changing itself. For detailed report, go back to the Xloader4.3 root directory and open pdf report.

To understand the process easily, just execute the compiled binary (available in release directory) in cmdline and map the printed details in memory...!!!

For Educational purposes only!
